edition = "2023";

package wayplatform.connect.tachograph.card.v1;

import "wayplatform/connect/tachograph/security/v1/authentication.proto";

// Represents the content of the EF_IC file, which contains identification data
// for the integrated circuit chip.
//
// The file structure is specified in Appendix 2, Section 4.1.
//
//     EF IC
//     └─CardChipIdentification
//
// The data type `CardChipIdentification` is specified in the Data Dictionary, Section 2.13.
//
// ASN.1 Definition:
//
//     CardChipIdentification ::= SEQUENCE {
//         icSerialNumber OCTET STRING (SIZE(4)),
//         icManufacturingReferences OCTET STRING (SIZE(4))
//     }
message Ic {
  // The serial number of the integrated circuit. The interpretation of this
  // value may be card-vendor specific.
  //
  // See Data Dictionary, Section 2.13, `icSerialNumber`.
  //
  // ASN.1 Definition:
  //
  //     OCTET STRING (SIZE(4))
  bytes ic_serial_number = 1;

  // The manufacturing references of the integrated circuit. The interpretation
  // of this value is card-vendor specific.
  //
  // See Data Dictionary, Section 2.13, `icManufacturingReferences`.
  //
  // ASN.1 Definition:
  //
  //     OCTET STRING (SIZE(4))
  bytes ic_manufacturing_references = 2;

  // Signature (non-compliant per Section 3.3, captured for data fidelity).
  //
  // ASN.1 Definition (Gen1):
  //
  //     Signature ::= OCTET STRING (SIZE(128))
  //
  // ASN.1 Definition (Gen2):
  //
  //     Signature ::= OCTET STRING (variable size, depends on elliptic curve)
  bytes signature = 3;

  // Result of cryptographic signature authentication for this Elementary File.
  // Present when signature verification has been performed.
  tachograph.security.v1.Authentication authentication = 99;
}
