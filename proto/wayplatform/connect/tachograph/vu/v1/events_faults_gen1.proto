edition = "2023";

package wayplatform.connect.tachograph.vu.v1;

import "wayplatform/connect/tachograph/dd/v1/vu_event_record.proto";
import "wayplatform/connect/tachograph/dd/v1/vu_fault_record.proto";
import "wayplatform/connect/tachograph/dd/v1/vu_overspeed_control_data.proto";
import "wayplatform/connect/tachograph/dd/v1/vu_overspeed_event_record.proto";
import "wayplatform/connect/tachograph/dd/v1/vu_time_adjustment_record.proto";
import "wayplatform/connect/tachograph/security/v1/authentication.proto";

// Events and Faults data for Generation 1 VU downloads.
//
// See Appendix 7, Section 2.2.6.4 (TREP 03 Hex).
//
// ASN.1 Definition:
//
//     VuEventsAndFaultsFirstGen ::= SEQUENCE {
//         vuFaultData VuFaultData,
//         vuEventData VuEventData,
//         vuOverSpeedingControlData VuOverSpeedingControlData,
//         vuOverSpeedingEventData VuOverSpeedingEventData,
//         vuTimeAdjustmentData VuTimeAdjustmentData,
//         signature SignatureFirstGen
//     }
message EventsAndFaultsGen1 {
  // All faults stored or on-going in the VU.
  //
  // See Data Dictionary, Section 2.200, `VuFaultData`.
  // See Data Dictionary, Section 2.201, `VuFaultRecord`.
  repeated dd.v1.VuFaultRecord faults = 1;

  // All events (except over speeding) stored or on-going in the VU.
  //
  // See Data Dictionary, Section 2.197, `VuEventData`.
  // See Data Dictionary, Section 2.198, `VuEventRecord`.
  repeated dd.v1.VuEventRecord events = 2;

  // Data related to the last overspeeding control.
  //
  // See Data Dictionary, Section 2.212, `VuOverSpeedingControlData`.
  dd.v1.VuOverspeedControlData overspeeding_control = 3;

  // All overspeeding events stored in the VU.
  //
  // See Data Dictionary, Section 2.214, `VuOverSpeedingEventData`.
  // See Data Dictionary, Section 2.215, `VuOverSpeedingEventRecord`.
  repeated dd.v1.VuOverspeedEventRecord overspeeding_events = 4;

  // All time adjustment events stored in the VU (outside a full calibration).
  //
  // See Data Dictionary, Section 2.229, `VuTimeAdjustmentData`.
  // See Data Dictionary, Section 2.232, `VuTimeAdjustmentRecord`.
  repeated dd.v1.VuTimeAdjustmentRecord time_adjustments = 5;

  // Signature for Gen1 data (RSA, 128 bytes).
  //
  // See Data Dictionary, Section 2.149, `Signature`.
  bytes signature = 6;

  // The raw, unparsed binary data of the complete Events and Faults transfer value.
  // This field is preserved for data fidelity and lossless round-trips.
  // It includes all data structures and the embedded signature.
  bytes raw_data = 7;

  // Result of cryptographic signature authentication for this transfer.
  // Present when signature verification has been performed.
  tachograph.security.v1.Authentication authentication = 99;
}
